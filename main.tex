\documentclass{IEEEtran}

\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{amsfonts}

\ifCLASSINFOpdf
   \usepackage[pdftex]{graphicx}
\else
   \usepackage[dvips]{graphicx}
\fi

\ifCLASSOPTIONcompsoc
  \usepackage[caption=false, font=normalsize, labelfont=sf, textfont=sf]{subfig}
\else
  \usepackage[caption=false, font=footnotesize]{subfig}
\fi

\usepackage{textcomp}
\usepackage{nicefrac}
\usepackage{siunitx}
\usepackage{fancyref}

\usepackage[style=ieee, doi=false, isbn=false, url=false, maxbibnames=1, minbibnames=1, maxcitenames=1, mincitenames=1, backend=biber, defernumbers=false]{biblatex}
\addbibresource{./references.bib}

% \AtEveryBibitem{\clearfield{month}}
% \AtEveryBibitem{\clearfield{day}}
% \AtEveryBibitem{\clearfield{volume}}
% \AtEveryBibitem{\clearfield{issue}}
% \AtEveryBibitem{\clearfield{pages}}
% \AtEveryBibitem{\clearfield{number}}
% \AtEveryBibitem{\clearfield{title}}
% \AtEveryBibitem{\clearfield{isbn}}
% \AtEveryBibitem{\clearfield{keywords}}
% \AtEveryBibitem{\clearfield{issn}}
% \AtEveryBibitem{\clearfield{journal}}

\usepackage[activate={true, nocompatibility}, final, tracking=true, kerning=true, spacing=true, factor=1100, stretch=10, shrink=10]{microtype}
% \linespread{0.9}

\input{glossaries}

\begin{document}
    \title{
        % \vspace{-0.75cm}
        
        Survival Analysis of Idiopathic Pulmonary Fibrosis Patients from CT
    }
    
    \author{
        % \vspace{-0.25cm}

        Ahmed~H.~Shahin,
        Alexander~C.~Whitehead~\IEEEmembership{Student~Member,~IEEE},
        An~Zhao,
        Daniel~C.~Alexander,
        Joseph~Jacob,
        and~David~Barber
    
        % \vspace{-0.75cm}

        \thanks{
            % \scriptsize
            This work was funded by \gls{OSIC}.
        }
        \thanks{
            % \scriptsize
            Ahmed~H.~Shahin, Alexander~C.~Whitehead, An~Zhao, Daniel~C.~Alexander, and David~Barber are with the Department of Computer Science, University College London, London, UK.
        }
        \thanks{
            % \scriptsize
            Ahmed~H.~Shahin, An~Zhao, Daniel~C.~Alexander, and Joseph~Jacob are with the Centre for Medical Image Computing, University College London, London, UK.
        }
        \thanks{
            % \scriptsize
            Joseph~Jacob is with Lungs for Living Research Centre, University College London, London, UK.
        }
        \thanks{
            % \scriptsize
            David~Barber is with the Centre for Artificial Intelligence, University College London, London, UK.
        }
        \thanks{
            % \scriptsize
            (contact: \texttt{alexander.whitehead.18@ucl.ac.uk}).
        }
    }
    
    \pagestyle{plain}
    \pagenumbering{gobble}
    
    \maketitle
    
    \begin{abstract}
        Idiopathic pulmonary fibrosis is a deadly disease with a non-linear heterogeneous progression. It would be useful both clinically, and for research, to be able to predict how this disease will progress, right up to the length of time for which a patient is expected to survive. Survival analysis is one such way to do this. Traditional methods, such as Cox, seek to rank participants based on their predicted survivability. However, Cox cannot directly output a survival time. DeepHit is a neural network based approach which simplifies to a classification problem, to predict the most likely histogram bin of survival time. A disadvantage of DeepHit is that an error of one year is equivalent to an error of one hundred years. A common problem encountered with survival models is that training data is often censored, where the exact time of death is unknown except that it is past a censoring time. Here, a comparison of neural network approaches utilising five different losses is presented. Three base losses are used, likelihood, Cox, and DeepHit. Two variations of likelihood (one which samples censoring time from a uniform and one from a Gaussian distribution) and two variations of Cox (classical and where a memory bank of previous predictions is used during ranking) are used. The input to each model is a single computed tomography volume (plus optionally information regarding the patients age and sex etc) and the output is a survival time. Improvements over previous work includes; a larger model with a learned downsampling, a parameterised activation (which starts linear and becomes non-linear), a softplus output, orthogonal initialisation, an optimiser integrating weight decay, gradient accumulation, and an annealed learning rate. Evaluations used include; mean and relative absolute error, the concordance index, the Brier score, and a visual analysis of Grad-CAM results. Overall, the likelihood trained models performed the best, with DeepHit a close second and Cox a distant last. The model trained with a likelihood using a uniform sampling of censoring time performed marginally better than the alternative. Results seemed mostly inconclusive about the incorporation of clinical features.
    \end{abstract}
    
    % \begin{IEEEkeywords}
        
    % \end{IEEEkeywords}
    
    \input{introduction}
    \input{methods}
    \input{results}
    \input{discussion_and_conclusion}
    
    % \vspace{-0.5cm}
    
    \AtNextBibliography{
        % \scriptsize
    }
    \printbibliography
\end{document}
